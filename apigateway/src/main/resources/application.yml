spring:
  application:
    name: ApiGateway project for Cathay Life Vietnam
#  r2dbc:
#    url: r2dbc:postgresql://${postgres_host}:${postgres_port}/${postgres_db}
#    username: ${postgres_user}
#    password: ${postgres_password}
#  sql:
#    init:
#      mode: always
#      schema-locations: classpath:schema.sql
#  data:
#    redis:
#      host: ${redis_host}
#      port: ${redis_port}
#      password: ${redis_password}
#      repositories:
#        enabled: false
  config:
    import: optional:file:./secret.properties

server:
  port: 8080

app:
  limits:
    max_body_size: 10MB      # Spring tự hiểu MB, KB
    max_header_size: 8KB
    max_query_params: 50

  cors:
    allowed_origins:
      - id: 0994f289-2063-48df-b747-3cb36b080d3e
        origin: http://localhost:5173
        enabled: true

      - id: dee179e6-da2d-468e-a206-8ed0d7f47c54
        origin: http://localhost:3000
        enabled: true

    allowed_headers:
      - id: a1b2c3d4-0001-4000-8000-000000000001
        header: Content-Type
        enabled: true

      - id: a1b2c3d4-0002-4000-8000-000000000002
        header: Authorization
        enabled: true
      
      - id: a1b2c3d4-0003-4000-8000-000000000003
        header: Accept
        enabled: true
      
      - id: a1b2c3d4-0004-4000-8000-000000000004
        header: Origin
        enabled: true
      
      - id: a1b2c3d4-0005-4000-8000-000000000005
        header: Access-Control-Request-Method
        enabled: true
      
      - id: a1b2c3d4-0006-4000-8000-000000000006
        header: Access-Control-Request-Headers
        enabled: true
      
      - id: a1b2c3d4-0007-4000-8000-000000000007
        header: X-XSRF-Token
        enabled: true
      
      - id: a1b2c3d4-0008-4000-8000-000000000008
        header: X-Request-Id
        enabled: true
      
      - id: a1b2c3d4-0009-4000-8000-000000000009
        header: X-Api-Key
        enabled: true

  # ============================================
  # TABLE: services
  # ============================================
  routes:
    services:
        - id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          name: identity-service
          url: http://127.0.0.1:8081
          path: /api/v1/identify-service/**
          enabled: true

        - id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          name: payment-service
          url: http://127.0.0.1:8082
          path: /api/v1/payment-service/**
          enabled: true

  # ============================================
  # TABLE: endpoints (FK: service_id -> services.id)
  # ============================================
  gateway:
      endpoints:
        # ========== IDENTIFY SERVICE: Auth ==========
        # Login - Public endpoint
        - id: 6851f442-4b73-46f8-9487-845f2791f6a6
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: POST
          path: /api/v1/identify-service/auth/login
          isPublic: true
          enabled: true

        # Register - Public endpoint
        - id: 291d53b9-175f-4dc4-821c-a05bdd780c41
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: POST
          path: /api/v1/identify-service/auth/register
          isPublic: true
          enabled: true

        # Logout - Protected (USER+)
        - id: 7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: POST
          path: /api/v1/identify-service/auth/logout
          isPublic: false
          min_role_level: 1
          enabled: true

        # Refresh Token - Protected (USER+)
        - id: 8b9c0d1e-2f3a-4b5c-6d7e-8f9a0b1c2d3e
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: POST
          path: /api/v1/identify-service/auth/refresh
          isPublic: false
          min_role_level: 1
          enabled: true

        # Forgot Password - Public endpoint
        - id: 0d1e2f3a-4b5c-6d7e-8f9a-0b1c2d3e4f5a
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: POST
          path: /api/v1/identify-service/auth/forgot-password
          isPublic: true
          enabled: true

        # Change Password - Protected (USER+)
        - id: 2f3a4b5c-6d7e-8f9a-0b1c-2d3e4f5a6b7c
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: PUT
          path: /api/v1/identify-service/auth/change-password
          isPublic: false
          min_role_level: 1
          enabled: true

        # Send Verification Email - Protected (USER+)
        - id: 3a4b5c6d-7e8f-9a0b-1c2d-3e4f5a6b7c8d
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: POST
          path: /api/v1/identify-service/auth/send-verification
          isPublic: false
          min_role_level: 1
          enabled: true

        # Verify Email - Public endpoint
        - id: 4b5c6d7e-8f9a-0b1c-2d3e-4f5a6b7c8d9e
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: GET
          path: /api/v1/identify-service/auth/verify-email/{token}
          isPublic: true
          enabled: false

        # ========== IDENTIFY SERVICE: Users ==========
        # Get Current User Account - Protected (USER+)
        - id: 608a9815-42c7-4c33-9b4a-bf4c52aeaa15
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: GET
          path: /api/v1/identify-service/users/me
          isPublic: false
          min_role_level: 1
          enabled: true

        # Admin Delete Account - Protected (ADMIN only)
        - id: 6d7e8f9a-0b1c-2d3e-4f5a-6b7c8d9e0f1a
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: DELETE
          path: /api/v1/identify-service/users/{userId}
          isPublic: false
          min_role_level: 4
          enabled: true

        # Admin Get Account by ID - Protected (MANAGER+)
        - id: 7e8f9a0b-1c2d-3e4f-5a6b-7c8d9e0f1a2b
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: GET
          path: /api/v1/identify-service/users/{userId}
          isPublic: false
          min_role_level: 3
          enabled: true

        # Admin List All Users - Protected (MANAGER+)
        - id: 4f5a6b7c-8d9e-0f1a-2b3c-4d5e6f7a8b9c
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: GET
          path: /api/v1/identify-service/users
          isPublic: false
          min_role_level: 3
          enabled: true

        # Admin Create User - Protected (ADMIN only)
        - id: 5a6b7c8d-9e0f-1a2b-3c4d-5e6f7a8b9c0d
          service_id: 8ba06267-5e36-4b87-ac05-fb657ae0d2bb
          method: POST
          path: /api/v1/identify-service/users
          isPublic: false
          min_role_level: 4
          enabled: true

        # ========== PAYMENT SERVICE ==========
        # Create Payment Method - Protected (USER+)
        - id: 1b2c3d4e-5f6a-7b8c-9d0e-1f2a3b4c5d6e
          service_id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          method: POST
          path: /api/v1/payment-service/payments/methods
          isPublic: false
          min_role_level: 1
          enabled: true

        # Create Payment - Protected (USER+)
        - id: 2c3d4e5f-6a7b-8c9d-0e1f-2a3b4c5d6e7f
          service_id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          method: POST
          path: /api/v1/payment-service/payments
          isPublic: false
          min_role_level: 1
          enabled: true

        # Cancel Payment - Protected (MANAGER+)
        - id: 3d4e5f6a-7b8c-9d0e-1f2a-3b4c5d6e7f8a
          service_id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          method: POST
          path: /api/v1/payment-service/payments/{paymentId}/cancel
          isPublic: false
          min_role_level: 3
          enabled: true

        # Get All Payments - Protected (USER+)
        - id: 4e5f6a7b-8c9d-0e1f-2a3b-4c5d6e7f8a9b
          service_id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          method: GET
          path: /api/v1/payment-service/payments
          isPublic: false
          min_role_level: 1
          enabled: true

        # Get Payment Methods - Protected (USER+)
        - id: 5f6a7b8c-9d0e-1f2a-3b4c-5d6e7f8a9b0c
          service_id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          method: GET
          path: /api/v1/payment-service/payments/methods
          isPublic: false
          min_role_level: 1
          enabled: true

        # Refund Payment - Protected (ADMIN only)
        - id: 6a7b8c9d-0e1f-2a3b-4c5d-6e7f8a9b0c1d
          service_id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          method: POST
          path: /api/v1/payment-service/payments/{paymentId}/refund
          isPublic: false
          min_role_level: 4
          enabled: true

        # Get All Transactions - Protected (MANAGER+)
        - id: 7b8c9d0e-1f2a-3b4c-5d6e-7f8a9b0c1d2e
          service_id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          method: GET
          path: /api/v1/payment-service/transactions
          isPublic: false
          min_role_level: 3
          enabled: true

        # Get Transaction by ID - Protected (MANAGER+)
        - id: 8c9d0e1f-2a3b-4c5d-6e7f-8a9b0c1d2e3f
          service_id: 1afb1335-ef97-4c31-ad8f-ce25c9384432
          method: GET
          path: /api/v1/payment-service/transactions/{transactionId}
          isPublic: false
          min_role_level: 3
          enabled: true

        
  # ============================================
  # TABLE: roles
  # ============================================
  security:
    roles:
        - id: a1b2c3d4-1111-4000-8000-000000000001
          name: ADMIN
          description: Administrator with full access
          level: 4
          enabled: true

        - id: a1b2c3d4-1111-4000-8000-000000000003
          name: MANAGER
          description: Manager with elevated permissions
          level: 3
          enabled: true

        - id: a1b2c3d4-1111-4000-8000-000000000004
          name: STAFF
          description: Guest user with read-only access
          level: 2
          enabled: true

        - id: a1b2c3d4-1111-4000-8000-000000000002
          name: USER
          description: Regular user with limited access
          level: 1
          enabled: true

    # endpoint_roles: REMOVED - replaced by min_role_level on each endpoint
  # ============================================
  # VALIDATION FILTER - Global validation rules
  # ============================================
  methods:
    method_rules:
        - id: d4e5f6a7-4444-4000-8000-000000000001
          method: POST
          require_body: true
          require_content_type: true
          max_body_size: 10485760

        - id: d4e5f6a7-4444-4000-8000-000000000002
          method: PUT
          require_body: true
          require_content_type: true
          max_body_size: 10485760

        - id: d4e5f6a7-4444-4000-8000-000000000003
          method: PATCH
          require_body: true
          require_content_type: true
          max_body_size: 10485760

        - id: d4e5f6a7-4444-4000-8000-000000000004
          method: GET
          require_body: false
          require_content_type: false
          max_body_size: 0

        - id: d4e5f6a7-4444-4000-8000-000000000005
          method: DELETE
          require_body: false
          require_content_type: false
          max_body_size: 0
  # ============================================
  # TABLE: header_rules
  # ============================================
  headers:
    header_rules:
      # ============================================
      # STANDARD HTTP HEADERS
      # ============================================
      - id: a1b2c3d4-aaaa-4000-8000-000000000001
        name: Host
        max_length: 255
        pattern: "^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?$"
        description: Hostname of the server (e.g., api.example.com, localhost:8080)

      - id: a1b2c3d4-aaaa-4000-8000-000000000002
        name: Accept
        max_length: 255
        pattern: "^[a-zA-Z0-9*+\\-./;=, ]+$"
        description: Media types that are acceptable for the response (e.g., application/json, text/html, */*)

      - id: a1b2c3d4-aaaa-4000-8000-000000000003
        name: Content-Type
        max_length: 100
        pattern: "^(application|text|multipart)/(json|xml|x-www-form-urlencoded|form-data|plain|html)(;\\s*charset=[a-zA-Z0-9-]+)?$"
        description: Media type of request body (application/json, multipart/form-data, etc.)

      - id: a1b2c3d4-aaaa-4000-8000-000000000004
        name: Content-Length
        max_length: 20
        pattern: "^[0-9]{1,20}$"
        description: Size of request body in bytes (numeric only)

      - id: a1b2c3d4-aaaa-4000-8000-000000000005
        name: User-Agent
        max_length: 500
        pattern: "^[a-zA-Z0-9._()/\\-;:, ]+$"
        description: User agent string (e.g., Mozilla/5.0, curl/7.68.0)

      - id: a1b2c3d4-aaaa-4000-8000-000000000006
        name: Accept-Encoding
        max_length: 100
        pattern: "^[a-z0-9\\-*,; .=]+$"
        description: Compression algorithms (gzip, deflate, br, identity)

      - id: a1b2c3d4-aaaa-4000-8000-000000000007
        name: Accept-Language
        max_length: 100
        pattern: "^[a-zA-Z]{2}(-[a-zA-Z]{2})?(,[a-zA-Z]{2}(-[a-zA-Z]{2})?)*$"
        description: Preferred languages (e.g., en-US, vi-VN, ja-JP)

      # ============================================
      # AUTHENTICATION & SECURITY HEADERS
      # ============================================
      - id: a1b2c3d4-aaaa-4000-8000-000000000010
        name: Authorization
        max_length: 4096
        pattern: '^Bearer\s+[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+\.[A-Za-z0-9_-]+$'
        description: Bearer JWT token or Basic auth credentials

      - id: a1b2c3d4-aaaa-4000-8000-000000000011
        name: X-API-Key
        max_length: 255
        pattern: "^[a-zA-Z0-9]{32,64}$"
        description: API key (32-64 alphanumeric characters)

      - id: a1b2c3d4-aaaa-4000-8000-000000000012
        name: X-CSRF-Token
        max_length: 255
        pattern: "^[a-zA-Z0-9\\-_=]{20,255}$"
        description: CSRF token (base64-like format)

      - id: a1b2c3d4-aaaa-4000-8000-000000000013
        name: Cookie
        max_length: 4096
        pattern: "^([a-zA-Z0-9_\\-]+=[^;]+)(;\\s*[a-zA-Z0-9_\\-]+=[^;]+)*$"
        description: HTTP cookies (name=value pairs separated by semicolons)

      # ============================================
      # CORS HEADERS
      # ============================================
      - id: a1b2c3d4-aaaa-4000-8000-000000000020
        name: Origin
        max_length: 255
        pattern: "^https?://[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?$"
        description: Origin of the request (e.g., http://localhost:3000, https://example.com)

      - id: a1b2c3d4-aaaa-4000-8000-000000000021
        name: Referer
        max_length: 2048
        pattern: "^https?://[a-zA-Z0-9\\-._~:/?#\\[\\]@!$&'()*+,;=%]+$"
        description: Full URL of previous page that linked to current request

      - id: a1b2c3d4-aaaa-4000-8000-000000000022
        name: Access-Control-Request-Method
        max_length: 50
        pattern: "^(GET|POST|PUT|DELETE|PATCH|OPTIONS|HEAD)$"
        description: HTTP method for CORS preflight request

      - id: a1b2c3d4-aaaa-4000-8000-000000000023
        name: Access-Control-Request-Headers
        max_length: 500
        pattern: "^[a-zA-Z0-9\\-]+(,\\s*[a-zA-Z0-9\\-]+)*$"
        description: Headers for CORS preflight (comma-separated list)

      # ============================================
      # CUSTOM TRACKING & MONITORING HEADERS
      # ============================================
      - id: a1b2c3d4-aaaa-4000-8000-000000000030
        name: X-Request-ID
        max_length: 128
        pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        description: UUID v4 format for request tracking

      - id: a1b2c3d4-aaaa-4000-8000-000000000031
        name: X-Correlation-ID
        max_length: 128
        pattern: "^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$"
        description: UUID format for correlation across distributed services

      - id: a1b2c3d4-aaaa-4000-8000-000000000032
        name: X-Trace-ID
        max_length: 128
        pattern: "^[0-9a-fA-F]{16,32}$"
        description: Zipkin/Jaeger trace ID (16 or 32 character hex string)

      - id: a1b2c3d4-aaaa-4000-8000-000000000033
        name: X-Span-ID
        max_length: 128
        pattern: "^[0-9a-fA-F]{16}$"
        description: Span ID for current operation (16 character hex string)

      - id: a1b2c3d4-aaaa-4000-8000-000000000034
        name: X-Client-IP
        max_length: 45
        pattern: "^(([0-9]{1,3}\\.){3}[0-9]{1,3}|([0-9a-fA-F]{0,4}:){7}[0-9a-fA-F]{0,4})$"
        description: Original client IP address (IPv4 or IPv6 format)

      - id: a1b2c3d4-aaaa-4000-8000-000000000035
        name: X-Forwarded-For
        max_length: 255
        pattern: "^([0-9]{1,3}\\.){3}[0-9]{1,3}(,\\s*([0-9]{1,3}\\.){3}[0-9]{1,3})*$"
        description: Comma-separated list of IPv4 addresses through proxies

      - id: a1b2c3d4-aaaa-4000-8000-000000000037
        name: X-Forwarded-Host
        max_length: 255
        pattern: "^[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(\\.[a-zA-Z0-9]([a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*(:[0-9]{1,5})?$"
        description: Original host requested by client

      - id: a1b2c3d4-aaaa-4000-8000-000000000038
        name: X-Real-IP
        max_length: 45
        pattern: "^(([0-9]{1,3}\\.){3}[0-9]{1,3}|([0-9a-fA-F]{0,4}:){7}[0-9a-fA-F]{0,4})$"
        description: Real IP address of client (IPv4 or IPv6 format)

    # ============================================
    # TABLE: endpoint_header_rules (Junction Table)
    # Many-to-Many: endpoints <-> header_rules
    # FK: endpoint_id -> endpoints.id, header_rule_id -> header_rules.id
    # ============================================
    endpoint_header_rules:
      # POST /auth/logout (Protected)
      - id: fd276eb2-5127-459e-97e2-02cfe256031b
        endpoint_id: 7a8b9c0d-1e2f-3a4b-5c6d-7e8f9a0b1c2d
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # PUT /auth/change-password (Protected)
      - id: 69acbd1c-1d40-4001-b8b7-78f447f28208
        endpoint_id: 2f3a4b5c-6d7e-8f9a-0b1c-2d3e4f5a6b7c
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true
 
      # POST /auth/send-verification (Protected)
      - id: a18015fc-f706-4ea3-8092-d58fd6837be9
        endpoint_id: 3a4b5c6d-7e8f-9a0b-1c2d-3e4f5a6b7c8d
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # GET /account (Protected)
      - id: 02ab1f8f-0c1d-4eb2-86b1-45186177b841
        endpoint_id: 608a9815-42c7-4c33-9b4a-bf4c52aeaa15
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # PUT /account (Protected)
      - id: 090fc8ef-c066-4de4-a43a-fa2062f7f2e4
        endpoint_id: 5c6d7e8f-9a0b-1c2d-3e4f-5a6b7c8d9e0f
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # DELETE /users/{userId} (Protected - Admin)
      - id: dc2647a8-716d-437d-a10d-fec76e0cafdb
        endpoint_id: 6d7e8f9a-0b1c-2d3e-4f5a-6b7c8d9e0f1a
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      - id: dc2647a8-716d-437d-a10d-fec76e0cafdc
        endpoint_id: 6d7e8f9a-0b1c-2d3e-4f5a-6b7c8d9e0f1a
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000030  # X-Request-ID
        required: true

      - id: dc2647a8-716d-437d-a10d-fec76e0cafdd
        endpoint_id: 6d7e8f9a-0b1c-2d3e-4f5a-6b7c8d9e0f1a
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000012  # X-CSRF-Token
        required: true

      - id: dc2647a8-716d-437d-a10d-fec76e0cafde
        endpoint_id: 6d7e8f9a-0b1c-2d3e-4f5a-6b7c8d9e0f1a
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000002  # Accept
        required: false

      - id: dc2647a8-716d-437d-a10d-fec76e0cafdf
        endpoint_id: 6d7e8f9a-0b1c-2d3e-4f5a-6b7c8d9e0f1a
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000005  # User-Agent
        required: false

      # GET /account/{id} (Protected - Admin)
      - id: 83674c8b-6a48-42f8-9d3f-31f9bdcc34ee
        endpoint_id: 7e8f9a0b-1c2d-3e4f-5a6b-7c8d9e0f1a2b
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # GET /profile (Protected)
      - id: 842b9fc1-8677-4876-a927-e7dce1a3426c
        endpoint_id: 8f9a0b1c-2d3e-4f5a-6b7c-8d9e0f1a2b3c
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # PUT /profile (Protected)
      - id: ecc6a191-2ba6-4855-b79f-84076ad0a4e4
        endpoint_id: 9a0b1c2d-3e4f-5a6b-7c8d-9e0f1a2b3c4d
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # POST /profile/picture (Protected)
      - id: 842b9fc1-8677-4876-a927-e7dce1a3426c
        endpoint_id: 0b1c2d3e-4f5a-6b7c-8d9e-0f1a2b3c4d5e
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # POST /auth/2fa/enable (Protected)
      - id: 8ddb1d5d-f0d6-4e67-afaa-0d2c3c4609bc
        endpoint_id: 1c2d3e4f-5a6b-7c8d-9e0f-1a2b3c4d5e6f
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # POST /auth/2fa/disable (Protected)
      - id: 255ff446-f670-4936-885a-ddf855195248
        endpoint_id: 2d3e4f5a-6b7c-8d9e-0f1a-2b3c4d5e6f7a
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # GET /users (Protected - Admin)
      - id: 142a7705-5ab7-4650-aac1-e85d374caab1
        endpoint_id: 4f5a6b7c-8d9e-0f1a-2b3c-4d5e6f7a8b9c
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # POST /users (Protected - Admin)
      - id: caa8cc98-adda-46be-bfdf-cc4e3ac5b800
        endpoint_id: 5a6b7c8d-9e0f-1a2b-3c4d-5e6f7a8b9c0d
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # PUT /users/{id} (Protected - Admin)
      - id: ecdf3416-f936-4439-97ed-16e11b5f0c58
        endpoint_id: 6b7c8d9e-0f1a-2b3c-4d5e-6f7a8b9c0d1e
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # DELETE /users/{id} (Protected - Admin)
      - id: 5370f652-e7a2-4118-bc60-303c0a8b48d0
        endpoint_id: 7c8d9e0f-1a2b-3c4d-5e6f-7a8b9c0d1e2f
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # PATCH /users/{id}/status (Protected - Admin)
      - id: 3cb73730-49f6-495f-ae9f-459a84ad76ad
        endpoint_id: 8d9e0f1a-2b3c-4d5e-6f7a-8b9c0d1e2f3a
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # GET /users/{id}/roles (Protected)
      - id: 8ea44e26-b7c4-4aaf-ac17-39b31168164f
        endpoint_id: 9e0f1a2b-3c4d-5e6f-7a8b-9c0d1e2f3a4b
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true
      
      # POST /users/{id}/roles (Protected - Admin)
      - id: ab0bab40-68a5-43c6-8922-1fc18ce69345
        endpoint_id: 0f1a2b3c-4d5e-6f7a-8b9c-0d1e2f3a4b5c
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

      # DELETE /users/{id}/roles/{roleId} (Protected - Admin)
      - id: 071ed01a-31b8-4c88-a031-6372fb37394e
        endpoint_id: 1a2b3c4d-5e6f-7a8b-9c0d-1e2f3a4b5c6d
        header_rule_id: a1b2c3d4-aaaa-4000-8000-000000000010  # Authorization
        required: true

    # ============================================

access_token:
  secret: ${access_token.secret}
  expire: ${access_token.expire}
refresh_token:
  secret: ${refresh_token.secret}
  expire: ${refresh_token.expire}

internal:
  api:
    key: ${internal.api.key}